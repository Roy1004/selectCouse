<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="images/logo.png" type="image/png">
    <title>查看学生信息</title>
    <link href="css/style.default.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="css/childStyle.css">
    <link rel="stylesheet" href="css/bootstrap-table.min.css">
    <style type="text/css">
        .list-group{margin-bottom: 0;}
        .list-group-item{padding:5px 15px;}
        .modal-header,.modal-footer{padding: 5px;}
    </style>
</head>
<body>
<div class="container-fluid child-page">
    <div class="panel panel-default user-info">
        <div class="panel-heading">
            <div class="row">
                <div class="right col-md-5">
                    <input type="text" name="grade" id="grade" class="input-sm col-md-2" placeholder="年级" autocomplete="off">
                    <input type="text" name="zymc" id="zymc" class="input-sm col-md-5" placeholder="专业名称" autocomplete="off">
                    <input type="text" name="bj" id="bj" class="input-sm col-md-2" placeholder="班级" autocomplete="off">
                    <button class="btn btn-primary" id="search1"><span class="glyphicon glyphicon-search style"></span>搜索</button>
                </div>
                <div class="right col-md-3">
                    <input type="text" name="sid" id="sid" class="col-md-6 input-sm" placeholder="学号" >
                    <button class="btn btn-primary" id="search2"><span class="glyphicon glyphicon-search style"></span>搜索</button>
                </div>
            </div>
        </div>
        <div class="panel-body panel-body-nopadding">
            <div id="toolbar">
                <!--<form class="form-inline" role="form">-->
                <div class="row">
                    <div class="right col-md-12">
                        <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#modal1" data-backdrop="static" id="add"><span class="glyphicon glyphicon-plus style"></span>添加</button>
                        <button class="btn btn-info btn-sm" data-toggle="modal" data-target="" data-backdrop="static" id="change"><span class="glyphicon glyphicon-pencil style"></span>修改</button>
                        <button class="btn btn-warning btn-sm"><span class="glyphicon glyphicon-trash style" id="del"></span>删除</button>
                    </div>
                </div>
                <!--</form>-->
            </div>
            <table class="table table-hover table-condensed" id="table1">
            </table>
        </div>
    </div>
    <div class="modal fade" id="modal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="Modal1Label">添加学生信息：</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal form-bordered form-inline" role="form" id="addInfo">
                        <ul class="list-group">
                            <li class="list-group-item"><label class="col-md-3" for="sid1">学号</label><input type="text" name="sid" id="sid1"></li>
                            <li class="list-group-item"><label class="col-md-3" for="sname1">姓名</label><input type="text" name="sname" id="sname1"></li>
                            <li class="list-group-item"><label class="col-md-3">性别</label><input type="radio" name="ssex" value="1">男&nbsp;<input type="radio" name="ssex" value="2">女</li>
                            <li class="list-group-item">
                                <label class="col-md-3" for="grade1">年级</label>
                                <select class="form-control grade" name="grade" id="grade1">
                                    <option value="1">2013</option>
                                    <option value="2">2014</option>
                                    <option value="3">2015</option>
                                    <option value="4">2016</option>
                                </select>
                            </li>
                            <li class="list-group-item">
                                    <label class="col-md-3">系别</label>
                                    <select class="form-control xb" name="xb" id="xb1">
                                        <option value="1">基础医学院</option>
                                        <option value="2">药学院</option>
                                        <option value="3">信息工程学院</option>
                                        <option value="4">管理学院</option>
                                        <option value="5">人文学院</option>
                                        <option value="6">外国语学院</option>
                                    </select>
                            </li>
                            <li class="list-group-item"><label class="col-md-3">专业名称</label><input type="text" name="zymc" id="zymc1"></li>
                            <li class="list-group-item"><label class="col-md-3">班级</label><input type="text" name="bj" id="bj1"></li>
                            <li class="list-group-item"><label class="col-md-3">密码</label><input type="text" name="spassword" id="spassword1"></li>
                        </ul>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="save1">保存</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="Modal1Labe2">修改学生信息：</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal form-bordered form-inline"  role="form" id="updateInfo">
                        <ul class="list-group">
                            <li class="list-group-item"><label class="col-md-3">学号</label><input type="text" name="sid" id="sid2"></span></li>
                            <li class="list-group-item"><label class="col-md-3">姓名</label><input type="text" name="sname" id="sname2"></li>
                            <li class="list-group-item"><label class="col-md-3">性别</label><input type="radio" name="ssex" value="1">男&nbsp;<input type="radio" name="ssex" value="2">女</li>
                            <li class="list-group-item">
                                <label class="col-md-3">年级</label>
                                <select class="form-control grade" name="grade" id="grade2" >
                                    <option value="1">2013</option>
                                    <option value="2">2014</option>
                                    <option value="3">2015</option>
                                    <option value="4">2016</option>
                                </select>
                            </li>
                            <li class="list-group-item">
                                <label class="col-md-3">系别</label>
                                <select class="form-control xb"  name="xb" id="xb2">
                                    <option value="1">基础医学院</option>
                                    <option value="2">药学院</option>
                                    <option value="3">信息工程学院</option>
                                    <option value="4">管理学院</option>
                                    <option value="5">人文学院</option>
                                    <option value="6">外国语学院</option>
                                </select>
                            </li>
                            <li class="list-group-item"><label class="col-md-3">专业名称</label><input type="text" name="zymc" id="zymc2"></li>
                            <li class="list-group-item"><label class="col-md-3">班级</label><input type="text" name="bj" id="bj2"></li>
                            <li class="list-group-item"><label class="col-md-3">密码</label><input type="text" name="spassword" id="spassword2"></li>
                        </ul>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="save2">保存</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="js/jquery-1.11.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/bootstrap-table.min.js"></script>
<script src="js/bootstrap-table-zh-CN.min.js"></script>
<script src="js/bootstrap-table-export.js"></script>
<script src="js/tableExport.js"></script>
<script src="js/jquery.serializejson.js"></script>
<script src="js/jquery.formautofill.min.js"></script>
<script type="text/javascript">
    $(function () {
        //1.初始化Table
        var oTable = new TableInit();
        oTable.Init();

        //2.初始化Button的点击事件
        /* var oButtonInit = new ButtonInit();
         oButtonInit.Init(); */
    });
    $("#search1").click(function () {
        if($('#grade').val()=="" || $('#zymc').val()==""  || $('#bj').val()=="" ){
            alert("请输入查询条件!");
        }else{
            $('#table1').bootstrapTable('refresh');
        }
    });
    $("#search2").click(function () {
        if($('#sid').val()==""){
            alert("请输入查询条件!");
        }else{
            $('#table1').bootstrapTable('refresh');
        }
    });
var TableInit = function () {
    var oTableInit = new Object();
    //初始化Table
    oTableInit.Init = function () {
         $('#table1').bootstrapTable({
            url: "person.json",
          //  method: 'post',
            cache: false,//禁止缓存
            dataType: "json",
            toolbar: '#toolbar',
            striped: false,//禁止条纹显示
            clickToSelect: true, //点击行就选中
            showColumns: true,  //显示隐藏列
            minimumCountColumns: 2,          //最少允许的列数
            showRefresh: true,  //显示刷新按钮
            /*singleSelect: false, //复选框只能选择一条记录*/
            pagination: true, //分页
       //     sidePagination: "server", //服务端处理分页
            /*showPaginationSwitch: false,//是否显示分页数*/
            pageNumber: 1,   //初始化加载第一页，默认第一页
            pageSize: 10,   //每页的记录行数（*）
            pageList: [10, 20], //可供选择的每页的行数（*）
            locale: 'zh-CN', //国际化
            queryParams: oTableInit.queryParams,//传递参数（*）
            queryParamsType: 'limit', //类型*/
            search:true,
             //strictSearch:true,
            showToggle : true, // 是否显示详细视图和列表视图的切换按钮
            cardView : false, // 是否显示详细视图
            uniqueId: "sid",
            showExport: true,                     //是否显示导出
            exportDataType: "basic", //basic'导出当前页, 'all'导出全部, 'selected'导出选中项.
            columns: [
        {
            checkbox:true
        },
        {
            title: '学号',
            field: 'sid',
            align: 'center',
            valign: 'middle'
        },
        {
            title: '姓名',
            field: 'sname',
            align: 'center',
            valign: 'middle'
        },
        {
            title: '性别',
            field: 'ssex',
            align: 'center'
        },
        {
            title: '年级',
            field: 'grade',
            align: 'center'
        },
        {
            title: '系别',
            field: 'xb',
            align: 'center'
        },
        {
            title: '专业',
            field: 'zymc',
            align: 'center'
        },
        {
            title: '班级',
            field: 'bj',
            align: 'center'
        },
        {
            title: '密码',
            field: 'spassword',
            align: 'center',
            visible: false
        }
        ]
    });
    };
    oTableInit.queryParams = function (params) {
        var temp = { //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
            limit: params.limit, //页面大小
            offset: params.offset, //页码
            zymc: $("#zymc").val(),
//            bj: $("#bj").val(),
//            grade: $("#grade").val(),
//            sid: $("#sid").val(),
            maxrows: params.limit,
            pageindex:params.pageNumber
        };
        return temp;
    };
    return oTableInit;
    };
    //删除学生信息
    $("#del").click(function () {
        var rows= $('#table1').bootstrapTable('getSelections');
        if (rows.length==0){
            alert("请选择你要删除的学生!");
            return;
        }
        var r=confirm("您确认要删掉这"+rows.length+"条学生信息吗？");
        if(r){
            for(i=0;i<rows.length;i++){
                $.ajax({
                        type: 'delete',
                        url:'api/illInfo/'+row[i]['sid'],
                    }
                )
            }
            $('#table1').bootstrapTable('refresh');
           /* $.ajax(
                {
                    type:"DELETE",
                    url:"",
                    data:JSON.stringify(rows),
                    success:function (reselt) {
                        if(result.errorMsg){
                            alert(result.errorMsg);
                        }else{
                           alert("您已成功删除<font color=red>"+selectedRows.length+"</font>条数据！");
                            $('#table1').bootstrapTable('refresh');
                        }
                    }
                }
            )*/
        }
    });
//保存添加的学生信息
    $("#save1").click(function () {
     var sid=$("#sid1").val();
     var sname=$("#sname1").val();
     var ssex=$("input[name='ssex']:checked").val();
     var zymc=$("#zymc1").val();
     var bj=$("#bj1").val();
     var spassword=$("#spassword1").val();
     if(sid=="" || sname=="" || ssex==null || zymc=="" || bj=="" || spassword==""){
         alert("信息填写不完整!");
         return;
     }else{
         $.ajax({
             type:"post",
             url:"",
             data:JSON.stringify( $('#addInfo').serializeJSON()),
             dataType:"json",
             success:function (result) {
                 if(result.errorMsg){
                     alert(result.errorMsg);
                     return;
                 }else{
                     alert("添加成功！");
                     // $("#user-table").datagrid("reload");
                 }
             }
         })
     }
    });
    //修改学生信息
    $("#change").click(function () {
        var rows = $('#table1').bootstrapTable('getSelections');
       if(rows.length!=1){
            alert("请选择一个学生!");
            $("#change").attr("data-target","");
            return;
        }else{
            $("#change").attr("data-target","#modal2");
            formAutofll("updateInfo",rows[0]);
        }
    })
    $("#save2").click(function () {
        $.ajax({
            type:"post",
            url:"",
            data:JSON.stringify( $('#updateInfo').serializeJSON()),
            dataType:"json",
            success:function (result) {
                if(result.errorMsg){
                    alert(result.errorMsg);
                    return;
                }else{
                    alert("修改成功！");
                    // $("#user-table").datagrid("reload");
                }
            }
        })
    });
</script>
</body>
</html>